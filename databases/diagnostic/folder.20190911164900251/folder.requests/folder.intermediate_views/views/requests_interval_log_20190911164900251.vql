CREATE OR REPLACE VIEW requests_interval_log_20190911164900251 FOLDER = '/20190911164900251/requests/intermediate_views' AS SELECT id, last_database_name AS database_name, last_user_name AS user_name, case WHEN (first_notification_type <> last_notification_type) THEN 'endRequest' ELSE first_notification_type END AS notification_type, last_session_id AS session_id, case WHEN (first_notification_type <> last_notification_type) THEN min_date WHEN (first_notification_type = 'startRequest') THEN min_date ELSE to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', start_time_as_text) END AS start_time, case WHEN (first_notification_type <> last_notification_type) THEN max_date WHEN (first_notification_type = 'endRequest') THEN min_date ELSE NULL END AS end_time, case first_notification_type WHEN 'startRequest' THEN last_duration_as_text ELSE first_duration_as_text END AS duration_as_text, case first_notification_type WHEN 'startRequest' THEN last_waiting_time_as_text ELSE first_waiting_time_as_text END AS waiting_time_as_text, case first_notification_type WHEN 'startRequest' THEN last_num_rows_as_text ELSE first_num_rows_as_text END AS num_rows_as_text, case first_notification_type WHEN 'startRequest' THEN last_state ELSE first_state END AS state, case first_notification_type WHEN 'startRequest' THEN last_cache_as_text ELSE first_cache_as_text END AS cache_as_text, last_query AS query, last_request_type AS request_type, case first_notification_type WHEN 'startRequest' THEN last_elements ELSE first_elements END AS elements, last_user_agent AS user_agent, last_access_interface AS access_interface, last_client_ip AS client_ip, case first_notification_type WHEN 'startRequest' THEN last_transaction_id_as_text ELSE first_transaction_id_as_text END AS transaction_id_as_text, last_webservice_name AS webservice_name FROM (SELECT requests_instant_log_20190911164900251.id, last(requests_instant_log_20190911164900251.database_name) AS last_database_name, last(requests_instant_log_20190911164900251.user_name) AS last_user_name, first(requests_instant_log_20190911164900251.notification_type) AS first_notification_type, last(requests_instant_log_20190911164900251.notification_type) AS last_notification_type, last(requests_instant_log_20190911164900251.session_id) AS last_session_id, requests_instant_log_20190911164900251.start_time_as_text, min(requests_instant_log_20190911164900251.date) AS min_date, max(requests_instant_log_20190911164900251.date) AS max_date, first(requests_instant_log_20190911164900251.duration_as_text) AS first_duration_as_text, last(requests_instant_log_20190911164900251.duration_as_text) AS last_duration_as_text, first(requests_instant_log_20190911164900251.waiting_time_as_text) AS first_waiting_time_as_text, last(requests_instant_log_20190911164900251.waiting_time_as_text) AS last_waiting_time_as_text, first(requests_instant_log_20190911164900251.num_rows_as_text) AS first_num_rows_as_text, last(requests_instant_log_20190911164900251.num_rows_as_text) AS last_num_rows_as_text, first(requests_instant_log_20190911164900251.state) AS first_state, last(requests_instant_log_20190911164900251.state) AS last_state, first(requests_instant_log_20190911164900251.cache_as_text) AS first_cache_as_text, last(requests_instant_log_20190911164900251.cache_as_text) AS last_cache_as_text, last(requests_instant_log_20190911164900251.query) AS last_query, last(requests_instant_log_20190911164900251.request_type) AS last_request_type, first(requests_instant_log_20190911164900251.elements) AS first_elements, last(requests_instant_log_20190911164900251.elements) AS last_elements, last(requests_instant_log_20190911164900251.user_agent) AS last_user_agent, last(requests_instant_log_20190911164900251.access_interface) AS last_access_interface, last(requests_instant_log_20190911164900251.client_ip) AS last_client_ip, first(requests_instant_log_20190911164900251.transaction_id_as_text) AS first_transaction_id_as_text, last(requests_instant_log_20190911164900251.transaction_id_as_text) AS last_transaction_id_as_text, last(requests_instant_log_20190911164900251.webservice_name) AS last_webservice_name FROM requests_instant_log_20190911164900251 WHERE cw_search_start_date = to_date('yyyy-MM-dd', '1970-01-01') GROUP BY requests_instant_log_20190911164900251.id, requests_instant_log_20190911164900251.start_time_as_text) CONTEXT ('I18N' = 'rfc_restful');

