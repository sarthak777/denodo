CREATE OR REPLACE VIEW cache_loads_interval_log_20190719155839371 FOLDER = '/20190719155839371/cache_loads/intermediate_views' AS SELECT session_id, case WHEN (first_notification_type <> last_notification_type) THEN 'endRefreshCacheProcess' ELSE first_notification_type END AS notification_type, id, query_pattern_id, last_database_name AS database_name, last_view_name AS view_name, last_sql_view_name AS sql_view_name, last_projected_fields AS projected_fields, last_num_conditions AS num_conditions, last_vdp_condition_list AS vdp_condition_list, last_cache_status AS cache_status, last_ttl_status_in_cache AS ttl_status_in_cache, last_ttl_in_cache AS ttl_in_cache, case first_notification_type WHEN 'startRefreshCacheProcess' THEN last_query_pattern_state ELSE first_query_pattern_state END AS query_pattern_state, case first_notification_type WHEN 'startRefreshCacheProcess' THEN last_exception ELSE first_exception END AS exception, max_num_inserted_rows AS num_inserted_rows, max_num_received_rows AS num_received_rows, case WHEN (first_notification_type <> last_notification_type) THEN min_date WHEN (first_notification_type = 'startRefreshCacheProcess') THEN min_date ELSE NULL END AS start_time, case WHEN (first_notification_type <> last_notification_type) THEN max_date WHEN (first_notification_type = 'endRefreshCacheProcess') THEN min_date ELSE NULL END AS end_time, case WHEN (first_notification_type <> last_notification_type) THEN (gettimeinmillis(max_date)-gettimeinmillis(min_date)) ELSE NULL END AS duration FROM (SELECT cache_loads_instant_log_20190719155839371.session_id, first(cache_loads_instant_log_20190719155839371.notification_type) AS first_notification_type, last(cache_loads_instant_log_20190719155839371.notification_type) AS last_notification_type, cache_loads_instant_log_20190719155839371.id, cache_loads_instant_log_20190719155839371.query_pattern_id, last(cache_loads_instant_log_20190719155839371.database_name) AS last_database_name, last(cache_loads_instant_log_20190719155839371.view_name) AS last_view_name, last(cache_loads_instant_log_20190719155839371.sql_view_name) AS last_sql_view_name, last(cache_loads_instant_log_20190719155839371.projected_fields) AS last_projected_fields, last(cache_loads_instant_log_20190719155839371.num_conditions) AS last_num_conditions, last(cache_loads_instant_log_20190719155839371.vdp_condition_list) AS last_vdp_condition_list, last(cache_loads_instant_log_20190719155839371.cache_status) AS last_cache_status, last(cache_loads_instant_log_20190719155839371.ttl_status_in_cache) AS last_ttl_status_in_cache, last(cache_loads_instant_log_20190719155839371.ttl_in_cache) AS last_ttl_in_cache, first(cache_loads_instant_log_20190719155839371.query_pattern_state) AS first_query_pattern_state, last(cache_loads_instant_log_20190719155839371.query_pattern_state) AS last_query_pattern_state, first(cache_loads_instant_log_20190719155839371.exception) AS first_exception, last(cache_loads_instant_log_20190719155839371.exception) AS last_exception, max(cache_loads_instant_log_20190719155839371.num_inserted_rows) AS max_num_inserted_rows, max(cache_loads_instant_log_20190719155839371.num_received_rows) AS max_num_received_rows, min(cache_loads_instant_log_20190719155839371.date) AS min_date, max(cache_loads_instant_log_20190719155839371.date) AS max_date FROM cache_loads_instant_log_20190719155839371 WHERE cw_search_start_date = to_date('yyyy-MM-dd', '1970-01-01') GROUP BY cache_loads_instant_log_20190719155839371.session_id, cache_loads_instant_log_20190719155839371.id, cache_loads_instant_log_20190719155839371.query_pattern_id) CONTEXT ('I18N' = 'rfc_restful');

