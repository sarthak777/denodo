CREATE OR REPLACE VIEW sessions_log_20190719155839371 FOLDER = '/20190719155839371/sessions' AS SELECT notification_type, connection_id, connection_start_time, case WHEN (notification_type <> 'loginOk') THEN connection_end_time WHEN (connection_start_time < to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.856')) THEN to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.855') WHEN (connection_start_time between to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.856') AND to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-07-19T10:33:33.890')) THEN to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-07-19T10:33:33.889') ELSE NULL END AS connection_end_time, nullif(client_ip, '-') AS client_ip, nullif(user_agent, '-') AS user_agent, nullif(access_interface, '-') AS access_interface, session_id, session_start_time, case WHEN (notification_type not in ('loginOk', 'openSession')) THEN session_end_time WHEN (session_start_time < to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.856')) THEN to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.855') WHEN (session_start_time between to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.856') AND to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-07-19T10:33:33.890')) THEN to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-07-19T10:33:33.889') ELSE NULL END AS session_end_time, nullif(login, '-') AS login, nullif(database_name, '-') AS database_name, nullif(webservice_name, '-') AS webservice_name, nullif(jms_queue_name, '-') AS jms_queue_name, nullif(intermediate_client_ip, '-') AS intermediate_client_ip, start_time, case WHEN (end_time is not null ) THEN end_time WHEN (start_time < to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.856')) THEN to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.855') WHEN (start_time between to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-06-21T13:16:23.856') AND to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-07-19T10:33:33.890')) THEN to_date('yyyy-MM-dd''T''HH:mm:ss.SSS', '2019-07-19T10:33:33.889') ELSE NULL END AS end_time FROM sessions_interval_log_20190719155839371 CONTEXT ('I18N' = 'rfc_restful');

ALTER VIEW sessions_log_20190719155839371
 CACHE FULL
     BATCHSIZEINCACHE DEFAULT TIMETOLIVEINCACHE NOEXPIRE
    DECLARE CACHE INDEX sessions_20190719155839371_start_time_idx ON (start_time ASC)
    DECLARE CACHE INDEX sessions_20190719155839371_end_time_idx ON (end_time ASC);

